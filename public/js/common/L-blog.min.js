/*! blog 31-05-2017 */

var app=angular.module("myApp",["ngSanitize"]);app.factory("adminLoginService",["$http",function(a){return{get:function(b,c){return console.log(2),a({method:"POST",url:"/admin/login",data:$.param({adminUser_username:b,adminUser_password:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})},find:function(){console.log(3)}}}]),app.factory("categoriesAddService",["$http",function(a){return{get:function(b,c,d,e,f){return console.log(b),console.log(c),console.log(d),console.log(e),console.log(f),a({method:"POST",url:"add",data:$.param({cate_name:b,cate_slug:c,cate_order:d,cate_parent:e,cate_remark:f}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("categoriesAllService",["$http",function(a){return{get:function(b,c,d,e,f,g,h,i,j,k,l,m){a({method:"POST",url:"admin/manage/articles_add",data:$.param({post_title:b,post_from:c,post_display:d,post_tags:e,post_img:f,cate_parent:g,post_keywords:h,post_discription:i,post_type:j,post_view:k,post_author:l,post_content:m}),headers:{"content-type":"applicatin/x-www-form-urlencoded"}})},getCategories:function(){return a({method:"GET",url:"/admin/manage/document_manage/categories_manage/get",headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("documentAllService",["$http",function(a){return{postLimitAndPage:function(b,c){return a({method:"POST",url:"/admin/manage/document_manage/get_yes_display_document",data:$.param({limit:b,page:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})},removeOneDocument:function(b){return a({method:"POST",url:"/admin/manage/document_manage/remove_one_document",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})},putIntoRecycle:function(b){return a({method:"POST",url:"/admin/manage/document_manage/put_into_recycle",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("documentEditService",["$http",function(a){return{get:function(b,c,d,e,f,g,h,i,j,k,l,m,n,o){return a({method:"POST",url:"/admin/manage/document_manage/write",data:$.param({document_title:b,document_from:c,document_display:d,document_hot:e,document_recommend:f,document_tags:g,document_img:h,document_category:i,document_keywords:j,document_abstract:k,document_type:l,document_view:m,document_author:n,document_content:o}),headers:{"content-type":"application/x-www-form-urlencoded"}})},postEditId:function(b){return a({method:"POST",url:"/admin/manage/document_manage/edit/",data:$.param({id:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})},update:function(b,c,d,e,f,g,h,i,j,k,l,m,n,o){return a({method:"POST",url:"/admin/manage/document_manage/update/",data:$.param({id:b,title:c,from:d,display:e,hot:f,recommend:g,tags:h,category:i,keywords:j,abstract:k,type:l,view:m,author:n,content:o}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("documentWriteService",["$http",function(a){return{get:function(b,c,d,e,f,g,h,i,j,k,l,m,n,o){return a({method:"POST",url:"/admin/manage/document_manage/write",data:$.param({document_title:b,document_from:c,document_display:d,document_hot:e,document_recommend:f,document_tags:g,document_img:h,document_category:i,document_keywords:j,document_abstract:k,document_type:l,document_view:m,document_author:n,document_content:o}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("draftService",["$http",function(a){return{postLimitAndPage:function(b,c){return a({method:"POST",url:"/admin/manage/document_manage/get_draft_document",data:$.param({limit:b,page:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})},removeOneDocument:function(b){return a({method:"POST",url:"/admin/manage/document_manage/remove_one_document",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})},putIntoRecycle:function(b){return a({method:"POST",url:"/admin/manage/document_manage/put_into_recycle",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("headerCtrlService",["$http",function(a){return{logout:function(){return a({method:"GET",url:"/admin/manage/logout",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.factory("noAccessService",["$http",function(a){return{postLimitAndPage:function(b,c){return a({method:"POST",url:"/admin/manage/document_manage/get_no_access_document",data:$.param({limit:b,page:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})},removeOneDocument:function(b){return a({method:"POST",url:"/admin/manage/document_manage/remove_one_document",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})},putIntoRecycle:function(b){return a({method:"POST",url:"/admin/manage/document_manage/put_into_recycle",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("passwordModifyService",["$http",function(a){return{get:function(b,c){return a({method:"POST",url:"/admin/manage/panel/password_modify",data:$.param({adminUser_password:b,adminUser_repassword:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("publishedService",["$http",function(a){return{postLimitAndPage:function(b,c){return a({method:"POST",url:"/admin/manage/document_manage/get_published_document",data:$.param({limit:b,page:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})},removeOneDocument:function(b){return a({method:"POST",url:"/admin/manage/document_manage/remove_one_document",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})},putIntoRecycle:function(b){return a({method:"POST",url:"/admin/manage/document_manage/put_into_recycle",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("recycleService",["$http",function(a){return{postLimitAndPage:function(b,c){return a({method:"POST",url:"/admin/manage/document_manage/get_no_display_document",data:$.param({limit:b,page:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})},removeOneDocument:function(b){return a({method:"POST",url:"/admin/manage/document_manage/remove_one_document",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("usersService",["$http",function(a){return{get:function(){return a({method:"GET",url:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.factory("usersAddService",["$http",function(a){return{get:function(b,c,d,e,f,g,h,i,j,k){return a({method:"POST",url:"add",data:$.param({adminUser_username:b,adminUser_nickname:c,adminUser_avatar:d,adminUser_password:e,adminUser_repassword:f,adminUser_userGroup:g,adminUser_status:h,adminUser_phone:i,adminUser_email:j,adminUser_remark:k}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.factory("usersGroupService",["$http",function(a){return{get:function(){return a({method:"GET",url:"users_group_get",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},modify:function(b,c){return a({method:"POST",url:"users_group/modify_power",data:$.param({name:b,power:c}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},forbidden:function(b){return a({method:"POST",data:$.param({name:b}),url:"forbidden",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},startUsing:function(b){return a({method:"POST",data:$.param({name:b}),url:"start_using",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.factory("usersGroupAddService",["$http",function(a){return{get:function(b,c,d,e,f){return a({method:"POST",url:"users_group_add/add",data:$.param({group_id:b,name:c,pid:d,status:e,remark:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},edit:function(b,c,d,e){return a({method:"POST",url:"users_group/edit",data:$.param({group_id:b,name:c,pid:d,remark:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.factory("waitForVerifyService",["$http",function(a){return{postLimitAndPage:function(b,c){return a({method:"POST",url:"/admin/manage/document_manage/get_wait_for_verify_document",data:$.param({limit:b,page:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})},removeOneDocument:function(b){return a({method:"POST",url:"/admin/manage/document_manage/remove_one_document",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})},putIntoRecycle:function(b){return a({method:"POST",url:"/admin/manage/document_manage/put_into_recycle",data:$.param({data:b}),headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.directive("pwCheck",[function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.pwCheck;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(e).val();d.$setValidity("pwmatch",a)})})}}}]),app.filter("trustHtml",function(a){return function(b){return a.trustAsHtml(b)}}),app.controller("adminLogin",["$scope","$http","adminLoginService",function(a,b,c){a.login=function(){c.get(a.adminUser_username,a.adminUser_password).then(function(a){1===a.data.code&&(window.location.href="/admin/manage")},function(a){})}}]),app.controller("categoriesAdd",["$scope","$http","categoriesAllService","$sce",function(a,b,c,d){c.getCategories().then(function(b){for(var c=b.data,d=[],e=0;e<c.length;e++)""===c[e].cate_parent&&d.push({name:c[e].cate_name,id:c[e].cate_slug,cate_name:c[e].cate_name,cate_slug:c[e].cate_slug});for(var f=0;f<d.length;f++)for(var g=0;g<c.length;g++)console.log(1),d[f].id===c[g].cate_parent&&d.splice(f+1,0,{name:"└"+c[g].cate_name,id:c[g].cate_slug,cate_name:c[g].cate_name,cate_slug:c[g].cate_slug});d.unshift({name:"无",id:""}),a.cateParentOptions=d,a.cate_parent=a.cateParentOptions[1].id},function(a){}),a.categoriesAdd=function(){a.myForm.$valid&&categoriesAddService.get(a.cate_name,a.cate_slug,a.cate_order,a.cate_parent,a.cate_remark).then(function(a){},function(a){})}}]),app.controller("categoriesAll",["$scope","$http","categoriesAllService",function(a,b,c){c.getCategories().then(function(b){for(var c=b.data,d=[],e=0;e<c.length;e++)""===c[e].cate_parent&&d.push({name:c[e].cate_name,id:c[e].cate_slug,cate_name:c[e].cate_name,cate_slug:c[e].cate_slug,cate_parent:c[e].cate_parent});for(var f=0;f<d.length;f++)for(var g=0;g<c.length;g++)console.log(1),d[f].id===c[g].cate_parent&&d.splice(f+1,0,{name:c[g].cate_name,id:c[g].cate_slug,cate_name:c[g].cate_name,cate_slug:c[g].cate_slug,cate_parent:c[g].cate_parent});a.data=d},function(a){})}]),app.controller("documentAll",["$scope","$http","documentAllService",function(a,b,c){c.postLimitAndPage(5,1).then(function(b){a.data=b.data.documentYesDisplayByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.limit="5",a.currentPage=1,a.getPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentYesDisplayByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.currentPage=1},a.goToPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentYesDisplayByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum,a.currentPage=d},function(a){})},a.removeOneDocument=function(b){a.oneDocument=b,$("#remove_one_document_modal").modal({keyboard:!0})},a.removeOneDocumentCommit=function(b){console.log(a.document_display.name),1==a.document_display.name?c.putIntoRecycle(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){}):c.removeOneDocument(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){})}}]),app.controller("documentEdit",["$scope","$http","documentEditService","categoriesAllService","$location",function(a,b,c,d,e){var f=e.absUrl(),g=/admin\/manage\/document_manage\/edit\/[a-z0-9]{24}/.exec(f)[0].slice(34,58);c.postEditId(g).then(function(b){a.data=b.data[0],a.document_title=a.data.document_title,a.document_from=a.data.document_from,a.document_display={name:String(a.data.document_display)},a.document_hot={name:String(a.data.document_hot)},a.document_recommend={name:String(a.data.document_recommend)},a.document_tags=a.data.document_tags,a.documentImg=a.data.document_img,console.log(a.documentImg),a.document_keywords=a.data.document_keywords,a.document_abstract=a.data.document_abstract,a.document_type={name:String(a.data.document_type)},a.document_view=a.data.document_view,a.document_author=a.data.document_author,ue.ready(function(){ue.setContent(a.data.document_content,!1)}),d.getCategories().then(function(b){for(var c=b.data,d=[],e=0;e<c.length;e++)""===c[e].cate_parent&&d.push({name:c[e].cate_name,id:c[e].cate_slug,cate_name:c[e].cate_name,cate_slug:c[e].cate_slug,cate_parent:c[e].cate_parent});for(var f=0;f<d.length;f++)for(var g=0;g<c.length;g++)d[f].id===c[g].cate_parent&&d.splice(f+1,0,{name:c[g].cate_name,id:c[g].cate_slug,cate_name:c[g].cate_name,cate_slug:c[g].cate_slug,cate_parent:c[g].cate_parent});a.cateOptions=d;for(var h=1,i=0;i<d.length;i++)if(d[i].cate_slug==a.data.document_category){h=i;break}a.document_category=a.cateOptions[h].id},function(a){})},function(a){}),a.updateDocument=function(){ue.ready(function(){a.document_content=ue.getContent()}),c.update(g,a.document_title,a.document_from,a.document_display.name,a.document_hot.name,a.document_recommend.name,a.document_tags,a.document_category,a.document_keywords,a.document_abstract,a.document_type.name,a.document_view,a.document_author,a.document_content).then(function(a){},function(a){})},$("#document_img").uploadify({swf:"/plugins/uploadify/uploadify.swf",uploader:"/admin/manage/document_manage/upload?documentTitle=document_title&type=images&key=document_img&id="+g,buttonText:"上传图片",buttonClass:"uploadify-btn-default",width:100,height:30,fileTypeDesc:"Image Files",fileTypeExts:"*.gif; *.jpg; *.png",fileSizeLimit:"2000KB",auto:!0,multi:!1,onUploadSuccess:function(b,c,d){a.documentImg=c}})}]),app.controller("documentWrite",["$scope","$http","documentWriteService","categoriesAllService",function(a,b,c,d){d.getCategories().then(function(b){for(var c=b.data,d=[],e=0;e<c.length;e++)""===c[e].cate_parent&&d.push({name:c[e].cate_name,id:c[e].cate_slug,cate_name:c[e].cate_name,cate_slug:c[e].cate_slug,cate_parent:c[e].cate_parent});for(var f=0;f<d.length;f++)for(var g=0;g<c.length;g++)d[f].id===c[g].cate_parent&&d.splice(f+1,0,{name:c[g].cate_name,id:c[g].cate_slug,cate_name:c[g].cate_name,cate_slug:c[g].cate_slug,cate_parent:c[g].cate_parent});a.cateOptions=d,a.document_category=a.cateOptions[1].id},function(a){}),a.document_display={name:"1"},a.document_hot={name:"1"},a.document_type={name:"post"},a.document_recommend={name:"0"},a.postImg="/upload/images/defaultlogo.png",a.documentWrite=function(){if(a.myForm.$valid){var b="";ue.ready(function(){b=ue.getContent(),a.document_content=b}),c.get(a.document_title,a.document_from,a.document_display.name,a.document_hot.name,a.document_recommend.name,a.document_tags,a.postImg,a.document_category,a.document_keywords,a.document_abstract,a.document_type.name,a.document_view,a.document_author,a.document_content).then(function(a){a.data.code},function(a){})}},a.postImg="/upload/images/defaultlogo.png",$("#post_img").uploadify({swf:"/plugins/uploadify/uploadify.swf",uploader:"/admin/manage/document_manage/upload?postTitle=post_title&type=images&key=post_img",buttonText:"上传图片",buttonClass:"uploadify-btn-default",width:100,height:30,fileTypeDesc:"Image Files",fileTypeExts:"*.gif; *.jpg; *.png",fileSizeLimit:"2000KB",auto:!0,multi:!1,onUploadSuccess:function(b,c,d){$("#post_img_preview").attr("src",c),a.postImg=c}})}]),app.controller("draft",["$scope","$http","draftService",function(a,b,c){c.postLimitAndPage(5,1).then(function(b){a.data=b.data.documentByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.limit="5",a.currentPage=1,a.getPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.currentPage=1},a.goToPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum,a.currentPage=d},function(a){})},a.removeOneDocument=function(b){a.oneDocument=b,$("#remove_one_document_modal").modal({keyboard:!0})},a.removeOneDocumentCommit=function(b){a.document_display={name:"1"},1==a.document_display.name?c.putIntoRecycle(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){}):c.removeOneDocument(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){})}}]),app.controller("headerCtrl",["$scope","$http","headerCtrlService",function(a,b,c){a.logout=function(){c.logout().then(function(a){1===a.data.code&&(window.location.href="/admin")},function(a){})}}]),app.controller("noAccess",["$scope","$http","noAccessService",function(a,b,c){c.postLimitAndPage(5,1).then(function(b){a.data=b.data.documentByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.limit="5",a.currentPage=1,a.getPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.currentPage=1},a.goToPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum,a.currentPage=d},function(a){})},a.removeOneDocument=function(b){a.oneDocument=b,$("#remove_one_document_modal").modal({keyboard:!0})},a.removeOneDocumentCommit=function(b){a.document_display={name:"1"},1==a.document_display.name?c.putIntoRecycle(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){}):c.removeOneDocument(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){})}}]),app.controller("passwordModify",["$scope","$http","passwordModifyService",function(a,b,c){a.passwordModify=function(){c.get(a.adminUser_password,a.adminUser_repassword).then(function(a){1===a.data.code&&$("#password_modify_modal").modal({keyboard:!0})},function(a){})}}]),app.controller("published",["$scope","$http","publishedService",function(a,b,c){c.postLimitAndPage(5,1).then(function(b){a.data=b.data.documentPublishedByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.limit="5",a.currentPage=1,a.getPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentPublishedByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.currentPage=1},a.goToPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentPublishedByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum,a.currentPage=d},function(a){})},a.removeOneDocument=function(b){a.oneDocument=b,$("#remove_one_document_modal").modal({keyboard:!0})},a.removeOneDocumentCommit=function(b){a.document_display={name:"1"},1==a.document_display.name?c.putIntoRecycle(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){}):c.removeOneDocument(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){})},a.edit=function(a){window.location.href="/admin/manage/document_manage/edit/"+a._id}}]),app.controller("recycle",["$scope","$http","recycleService",function(a,b,c){c.postLimitAndPage(5,1).then(function(b){a.data=b.data.documentNoDisplayByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.limit="5",a.currentPage=1,a.getPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentNoDisplayByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.currentPage=1},a.goToPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentNoDisplayByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum,a.currentPage=d},function(a){})},a.removeOneDocument=function(b){a.oneDocument=b,$("#remove_one_document_complete_modal").modal({keyboard:!0})},a.removeOneDocumentCommit=function(b){c.removeOneDocument(b).then(function(b){1===b.data.code&&($("#remove_one_document_complete_modal").modal("hide"),a.getPage())},function(a){})}}]),app.controller("usersGroupAdd",["$scope","$http","usersGroupAddService",function(a,b,c){a.statusOptions=[{name:"启用",id:1},{name:"禁用",id:0}],a.status=a.statusOptions[0].id,a.pidOptions=[{name:"无",id:0},{name:"超级管理员",id:1},{name:"网站管理员",id:2},{name:"内容管理员",id:3},{name:"投稿员",id:4}],a.pid=a.pidOptions[0].id,a.addAdminUserGroup=function(){var b=a.name,d=a.pid,e=a.status,f=a.remark,g="超级管理员";switch(b){case"超级管理员":g=1;break;case"网站管理员":g=2;break;case"内容管理员":g=3}c.get(g,b,d,e,f).then(function(a){1==a.data.code&&$("#myModal").modal({keyboard:!0})},function(a){})},$("#myModal").on("hidden.bs.modal",function(){window.location="/admin/users_group"}),$("#myModal").on("hide.bs.modal",function(){window.location="/admin/users_group"})}]),app.controller("users",["$scope","$http","usersService",function(a,b,c){c.get().then(function(b){a.data=b.data,console.log(a.data)},function(a){})}]),app.controller("usersAdd",["$scope","$http","usersAddService",function(a,b,c){a.addAdminUser=function(){var b=1;switch(a.adminUser_userGroup){case 1:b="超级管理员";break;case 2:b="网站管理员";break;case 3:b="内容管理员";break;case 4:b="投稿员"}if(!a.myForm.$valid)return!1;c.get(a.adminUser_username,a.adminUser_nickname,a.logo,a.adminUser_password,a.adminUser_repassword,b,a.adminUser_status,a.adminUser_phone,a.adminUser_email,a.adminUser_remark).then(function(a){},function(a){})},a.userGroupOptions=[{name:"超级管理员",id:1},{name:"网站管理员",id:2},{name:"内容管理员",id:3},{name:"投稿员",id:4}],a.adminUser_userGroup=a.userGroupOptions[0].id,a.statusOptions=[{name:"启用",id:1},{name:"禁用",id:0}],a.adminUser_status=a.statusOptions[0].id,a.checkUsername=function(c){var d=$.trim(c);if(a.isUsernameExist=!1,""==d)return!1;b({method:"POST",url:"add",data:$.param({adminUser_username:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(b){0==b.data.code&&(a.isUsernameExist=!0)},function(a){})},a.logo="/upload/images/defaultlogo.png",$("#adminUser_avatar").uploadify({swf:"/plugins/uploadify/uploadify.swf",uploader:"/admin/manage/users_manage/upload?adminId=adminUser_username&type=images&key=adminUser_avatar",buttonText:"上传图片",buttonClass:"uploadify-btn-default",width:100,height:30,fileTypeDesc:"Image Files",fileTypeExts:"*.gif; *.jpg; *.png",fileSizeLimit:"2000KB",auto:!0,multi:!1,onUploadSuccess:function(b,c,d){$("#adminUser_avatar_preview").attr("src",c),a.logo=c}})}]),app.controller("usersGroup",["$scope","$http","usersGroupService","usersGroupAddService",function(a,b,c,d){function e(){i=$.fn.zTree.getZTreeObj("treeDemo"),py=$("#py").attr("checked")?"p":"",sy=$("#sy").attr("checked")?"s":"",pn=$("#pn").attr("checked")?"p":"",sn=$("#sn").attr("checked")?"s":"",type={Y:py+sy,N:pn+sn},i.setting.check.chkboxType=type,f('setting.check.chkboxType = { "Y" : "'+type.Y+'", "N" : "'+type.N+'" };')}function f(a){h||(h=$("#code")),h.empty(),h.append("<li>"+a+"</li>")}function g(){c.get().then(function(b){a.data=b.data},function(a){})}g();var h,i,j={check:{enable:!0,chkStyle:"checkbox",chkboxType:{Y:"ps",N:"ps"}},data:{simpleData:{enable:!0}},callback:{}},k=[{id:"panel",pId:0,name:"仪表盘",open:!0,children:[{id:"panel_index",pId:"panel",name:"仪表盘首页"},{id:"basic_info",pId:"panel",name:"基本信息"},{id:"password_modify",pId:"panel",name:"修改密码"}]},{id:"users_manage",pId:0,name:"用户管理",open:!0,children:[{id:"users_group_manage",pId:"usersManage",name:"用户组管理",children:[{id:"users_group",pId:"users_group_manage",name:"所有用户组"},{id:"users_group_add",pId:"users_group_manage",name:"添加用户组"}]},{id:"users",pId:"usersManage",name:"所有用户"},{id:"users_add",pId:"usersManage",name:"添加用户"}]},{id:"document_manage",pId:0,name:"文档管理",open:!0,children:[{id:"categories_manage",pId:"document_manage",name:"分类管理",open:!0,children:[{id:"document_categories",pId:"categories_manage",name:"文档分类"},{id:"document_categories_add",pId:"categories_manage",name:"添加分类"}]},{id:"menu_manage",pId:"document_manage",name:"菜单管理",children:[{id:"menu_edit",pId:"menu_manage",name:"编辑菜单"},{id:"menu_location",pId:"menu_manage",name:"菜单位置"}]},{id:"post_manage",pId:"document_manage",name:"文章管理",children:[{id:"post_write",pId:"post_manage",name:"写文章"},{id:"posts",pId:"post_manage",name:"所有文章"},{id:"post_wait",pId:"post_manage",name:"待审核"},{id:"post_no_access",pId:"post_manage",name:"未通过"},{id:"post_published",pId:"post_manage",name:"已发布"},{id:"post_draft",pId:"post_manage",name:"草稿箱"},{id:"post_recycle",pId:"post_manage",name:"回收站"}]},{id:"tags_manage",pId:"document_manage",name:"标签管理"},{id:"comments_manage",pId:"document_manage",name:"评论管理"},{id:"messages_manage",pId:"document_manage",name:"消息管理"}]},{id:"files_manage",pId:0,name:"文件管理",open:!0,children:[{id:"media_manage",pId:"files_manage",name:"媒体管理"},{id:"files_backup",pId:"files_manage",name:"文件备份"},{id:"files_recover",pId:"files_manage",name:"文件恢复"}]},{id:"data_manage",pId:0,name:"数据管理",open:!0,children:[{id:"database_manage",pId:"data_manage",name:"数据库管理",open:!0,children:[{id:"database_backup",pId:"data_manage",name:"数据库备份"},{id:"database_in",pId:"data_manage",name:"数据库导入"},{id:"database_compress",pId:"data_manage",name:"数据库压缩"},{id:"database_optimise",pId:"data_manage",name:"数据库优化"}]},{id:"cache_manage",pId:"data_manage",name:"缓存管理",open:!0,children:[{id:"cache_clear",pId:"cache_manage",name:"缓存清理"},{id:"cache_settings",pId:"cache_manage",name:"缓存设置"}]},{id:"count_manage",pId:"data_manage",name:"统计管理",open:!0,children:[{id:"data_count",pId:"count_manage",name:"数据统计"}]}]},{id:"Custom_center",pId:0,name:"定制中心",open:!0,children:[{id:"theme_manage",pId:"Custom_center",name:"主题管理"},{id:"plugins_manage",pId:"Custom_center",name:"插件管理"},{id:"hooks_manage",pId:"Custom_center",name:"钩子管理"},{id:"ad_manage",pId:"Custom_center",name:"广告管理"}]},{id:"system_settings",pId:0,name:"系统设置",open:!0,children:[{id:"system_log",pId:"system_settings",name:"系统日志"},{id:"website_settings",pId:"system_settings",name:"站点设置"},{id:"read_settings",pId:"system_settings",name:"阅读设置"},{id:"attachment_settings",pId:"system_settings",name:"附件设置"},{id:"social_login_settings",pId:"system_settings",name:"社交登录设置"},{id:"update_online",pId:"system_settings",name:"在线更新"},{id:"system_info",pId:"system_settings",name:"系统信息"},{id:"bugs_commit",pId:"system_settings",name:"BUG反馈"}]}],l=[],m={};$(document).ready(function(){$.fn.zTree.init($("#treeDemo"),j,k),e(),$("#py").bind("change",e),$("#sy").bind("change",e),$("#pn").bind("change",e),$("#sn").bind("change",e)}),a.powerCommit=function(){l=i.transformToArray(i.getNodes());for(var b=0;b<l.length;b++)m[l[b].id]=l[b].checked;c.modify(a.userGroup,m).then(function(a){1===a.data.code&&$("#users_group_modal").modal("hide")},function(a){})},a.setPower=function(b){function d(a){return"true"===a?a=!0:"false"===a&&(a=!1),a}console.log(1),a.userGroup=b;var e,f;c.get().then(function(c){a.data=c.data,e=a.data;for(var g=0;g<e.length;g++)e[g].name==b&&(f=JSON.parse(e[g].power));l=i.transformToArray(i.getNodes());for(var h=0,j=l.length;h<j;h++)l[h].checked=d(f[l[h].id]);for(var k=0;k<l.length;k++)i.checkNode(l[k],l[k].checked,!0)},function(a){})},a.forbidden=function(a){c.forbidden(a).then(function(){g()},function(){})},a.startUsing=function(a){c.startUsing(a).then(function(){g()},function(){})},a.edit=function(b){a.user=b,a.pidOptions=[{name:"无",id:0},{name:"超级管理员",id:1},{name:"网站管理员",id:2},{name:"内容管理员",id:3}],a.pid=a.user.pid},a.editCommit=function(a){var b=a.name,c=a.pid,e=a.remark,f="超级管理员";switch(b){case"超级管理员":f=1;break;case"网站管理员":f=2;break;case"内容管理员":f=3;break;default:f=4}d.edit(f,b,c,e).then(function(a){1===a.data.code&&$("#myModal").modal({keyboard:!0})},function(a){})}}]),app.controller("waitForVerify",["$scope","$http","waitForVerifyService",function(a,b,c){c.postLimitAndPage(5,1).then(function(b){a.data=b.data.documentWaitForVerifyByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.limit="5",a.currentPage=1,a.getPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentWaitForVerifyByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum},function(a){}),a.currentPage=1},a.goToPage=function(b,d){c.postLimitAndPage(b,d).then(function(b){a.data=b.data.documentWaitForVerifyByLimitAndPage,a.allPage=b.data.allPage,a.documentCountNum=b.data.documentCountNum,a.currentPage=d},function(a){})},a.removeOneDocument=function(b){a.oneDocument=b,$("#remove_one_document_modal").modal({keyboard:!0})},a.removeOneDocumentCommit=function(b){a.document_display={name:"1"},1==a.document_display.name?c.putIntoRecycle(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){}):c.removeOneDocument(b).then(function(b){1===b.data.code&&($("#remove_one_document_modal").modal("hide"),a.getPage())},function(a){})}}]);